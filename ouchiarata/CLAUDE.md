# プロジェクト概要
1. このプロジェクト名は`${プロジェクト名}`である
2. 完成したら、`https://${ドメイン}`で公開される
3. 製作者は`Arata Ouchi (${Original SIN Architecture または Philtz})`である
4. 製作者のX（Twitter）アカウントのURLは`https://x.com/ouchiarata`である
5. 製作者のホームページURLは`https://${osa.xyz または philtz.com}$`である
6. ページタイトルは`${ページタイトル}`、短い説明は`${サイト内キャッチコピー等に使用できる短い説明}`、長い説明は`${ページデスクリプション等に使用できる正式な説明}`である
7. ドメインはCloudflareで管理されており、Vercelにデプロイされる

# コード規則
1. 変数名は`snake_case`、関数名は`camelCase`、型名は`PascalCase`、環境変数は`CONTACT_CASE`
2. インデントはスペース4つ
3. コード内の命名は冗長でも良いのでわかりやすい名前をつける（NG例: `const handle = () => {}`）
4. 必要ない部分にセミコロンを記載しない
5. ダブルクォーテーションを優先する
6. 後方互換性を保つ必要があると判断した場合はユーザーに確認を行う
7. 定数にフォールバックを用いない（NG例：`web_url: process.env.WEB_URL || 'http://localhost:3000'`）
8. 関数にフォールバックを用いず、失敗時にはエラーを返す
9. 全てのエラーメッセージは単一のファイル内に記述する
10. 全てのログメッセージは単一のファイル内に記述する
11. 全ての型は単位のディレクトリ内にファイルを作って記述する
12. 変数名はなるべくオブジェクト化して一単語に均一化する（例: `worksName` -> `works.name`）
13. モジュラー・モノリス構造を用いる
14. 環境変数名に`NUXT_`や`NUXT_PUBLIC_`といったプレフィクスを用いない

## パッケージ
1. `npm install`コマンドを用いてパッケージをインストールし、`package.json`に直接記載しない
2. Nuxtを使用する場合はバージョン4.2.2を使用する
3. Firebaseを使用する際は`firebase-admin`を使用し、クライアントパッケージを使用しない。
4. 日付にまつわる処理を行う場合`date-fns`を利用する。
5. Unkeyを利用する際は`verifyKey()`ではなく`getUnkeyClient().keys.verify()`を利用し、有料のレート制限枠を使用する

## Google Analytics

1. Cookieの利用について尋ね、同意されたら同意シグナルを送る
2. `analytics_storage` は常に `granted`（基本的なアクセス解析は常時有効）
3. `ad_storage`, `ad_user_data`, `ad_personalization` はデフォルト `denied`
4. ユーザーが「同意する」を選択した場合のみ、広告系も `granted` に更新

# 動作規則
1. `llm/models.yaml`に、全てのデータモデルを記載し、実装が変更されたら同ファイルも必ずアップデートする
2. 環境変数が変更されたら`.env.example`を更新する
3. 一括置換が望ましい場合、`temp/`内に`.js`スクリプトを記載して実行することでコードを修正し、使用し終わったらスクリプトを削除する
4. バックグラウンドで`npm run dev`を実行せず、必ずユーザーに実行を促す
5. ESLint, Prittierを導入して適宜フォーマットコマンドを実行する
6. 常に日本語で応答する

## マイグレーション手順
1. マイグレーションの対象となるデータ件数を取得するAPIを作成
2. マイグレーションを行うAPIを作成し、Dry-Runを実行
3. あらかじめ取得したデータ件数と、Dry-Runで変更された件数が一致したことを確認、一致しない場合修正
4. 一致した場合にマイグレーションを行、APIを削除

# 禁止事項
1. 全ての`git`コマンドの使用を禁じる
2. Vercelへのデプロイや本番環境へ影響を及ぼす操作を禁じる